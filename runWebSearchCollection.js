const RealWebSearchRestaurantAgent = require('./realWebSearchAgent');

// WebSearch API ì‹œë®¬ë ˆì´ì…˜ í•¨ìˆ˜ (ì‹¤ì œ í™˜ê²½ì—ì„œëŠ” ì‹¤ì œ WebSearch í•¨ìˆ˜ë¥¼ ì‚¬ìš©)
async function webSearchFunction(query) {
    console.log(`  ğŸŒ WebSearch API í˜¸ì¶œ: "${query}"`);
    
    // ì‹¤ì œ WebSearch ê²°ê³¼ë¥¼ ì‹œë®¬ë ˆì´ì…˜ 
    // ì‹¤ì œ ì‚¬ìš© ì‹œì—ëŠ” ì´ ë¶€ë¶„ì„ ì‹¤ì œ WebSearch API í˜¸ì¶œë¡œ êµì²´
    return simulateWebSearchResults(query);
}

// ì›¹ ê²€ìƒ‰ ê²°ê³¼ ì‹œë®¬ë ˆì´ì…˜ (ì‹¤ì œ ê²€ìƒ‰ íŒ¨í„´ ê¸°ë°˜)
function simulateWebSearchResults(query) {
    const results = [];
    
    // í•´ìš´ëŒ€ ë§›ì§‘ ê´€ë ¨ ê²€ìƒ‰ ê²°ê³¼ ì‹œë®¬ë ˆì´ì…˜
    if (query.includes('í•´ìš´ëŒ€') && query.includes('ë§›ì§‘')) {
        results.push({
            title: "2024ë…„ í•´ìš´ëŒ€ ë§›ì§‘ ë² ìŠ¤íŠ¸ 10 - í˜„ì§€ì¸ ì¶”ì²œ",
            snippet: "ê¸ˆìˆ˜ë³µêµ­ í•´ìš´ëŒ€ë³¸ì  ë¶€ì‚°ê´‘ì—­ì‹œ í•´ìš´ëŒ€êµ¬ ë‹¬ë§ì´ê¸¸62ë²ˆê¸¸ 46 ë³µì–´ìš”ë¦¬ ì „ë¬¸ 46ë…„ ì „í†µ 4.5ì  20000-40000ì›",
            content: "í•´ìš´ëŒ€ ëŒ€í‘œ ë§›ì§‘ìœ¼ë¡œ 46ë…„ ì „í†µì„ ìë‘í•˜ëŠ” ê¸ˆìˆ˜ë³µêµ­ í•´ìš´ëŒ€ë³¸ì ì…ë‹ˆë‹¤. ë¶€ì‚°ê´‘ì—­ì‹œ í•´ìš´ëŒ€êµ¬ ë‹¬ë§ì´ê¸¸62ë²ˆê¸¸ 46ì— ìœ„ì¹˜í•˜ë©° ë³µì–´ìš”ë¦¬ ì „ë¬¸ì ìœ¼ë¡œ ìœ ëª…í•©ë‹ˆë‹¤."
        });
        
        results.push({
            title: "í•´ìš´ëŒ€ ì˜¤ë³µë¼ì§€êµ­ë°¥ - 24ì‹œê°„ ì˜ì—… ë§›ì§‘",
            snippet: "í•´ìš´ëŒ€ ì˜¤ë³µë¼ì§€êµ­ë°¥ ë¶€ì‚°ê´‘ì—­ì‹œ í•´ìš´ëŒ€êµ¬ êµ¬ë‚¨ë¡œ 15 1ì¸µ 24ì‹œê°„ ì˜ì—… í•´ìš´ëŒ€ì—­ ê·¼ì²˜ 8000-12000ì›",
            content: "í•´ìš´ëŒ€ì—­ 3ë²ˆ ì¶œêµ¬ ì•ì— ìœ„ì¹˜í•œ 24ì‹œê°„ ì˜ì—… ë¼ì§€êµ­ë°¥ ì „ë¬¸ì ì…ë‹ˆë‹¤. ë¶€ì‚°ê´‘ì—­ì‹œ í•´ìš´ëŒ€êµ¬ êµ¬ë‚¨ë¡œ 15 1ì¸µì—ì„œ ì–¸ì œë“ ì§€ ë”°ëœ»í•œ ë¼ì§€êµ­ë°¥ì„ ë“œì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤."
        });
    }
    
    if (query.includes('ì„¼í…€') || query.includes('ì„¼í…€ì‹œí‹°')) {
        results.push({
            title: "ì„¼í…€ì‹œí‹° ë§›ì§‘ - ìˆ˜ë³€ìµœê³ ë¼ì§€êµ­ë°¥",
            snippet: "ìˆ˜ë³€ìµœê³ ë¼ì§€êµ­ë°¥ ì„¼í…€ì  ë¶€ì‚°ê´‘ì—­ì‹œ í•´ìš´ëŒ€êµ¬ ì„¼í…€3ë¡œ 26 2ì¸µ í•­ì •êµ­ë°¥ ì „ë¬¸ 0507-1481-8897",
            content: "ì„¼í…€ì‹œí‹°ì—­ì—ì„œ ê°€ê¹Œìš´ í•­ì •êµ­ë°¥ ì „ë¬¸ì ì…ë‹ˆë‹¤. ë¶€ì‚°ê´‘ì—­ì‹œ í•´ìš´ëŒ€êµ¬ ì„¼í…€3ë¡œ 26 2ì¸µì— ìœ„ì¹˜í•˜ë©° ì „í™”ë²ˆí˜¸ëŠ” 0507-1481-8897ì…ë‹ˆë‹¤."
        });
        
        results.push({
            title: "ìŠ¤ì‹œì•¼ë§ˆ ì„¼í…€ì‹œí‹°ì  - ê³ ê¸‰ ì¼ì‹",
            snippet: "ìŠ¤ì‹œì•¼ë§ˆ ì„¼í…€ì‹œí‹°ì  ë¶€ì‚°ê´‘ì—­ì‹œ í•´ìš´ëŒ€êµ¬ ì„¼í…€ë‚¨ëŒ€ë¡œ 50 ì„¼í…€ì„í˜ë¦¬ì–¼íƒ€ì›Œë¹Œë”© 1ì¸µ ê³ ê¸‰ ìŠ¤ì‹œ ì „ìš©ì£¼ì°¨ì¥",
            content: "ì„¼í…€ì‹œí‹°ì˜ ëŒ€í‘œ ì¼ì‹ ë§›ì§‘ ìŠ¤ì‹œì•¼ë§ˆì…ë‹ˆë‹¤. ë¶€ì‚°ê´‘ì—­ì‹œ í•´ìš´ëŒ€êµ¬ ì„¼í…€ë‚¨ëŒ€ë¡œ 50 ì„¼í…€ì„í˜ë¦¬ì–¼íƒ€ì›Œë¹Œë”© 1ì¸µì—ì„œ ê³ ê¸‰ ìŠ¤ì‹œë¥¼ ì¦ê¸°ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤."
        });
    }
    
    if (query.includes('ì†¡ì •')) {
        results.push({
            title: "ì†¡ì • ìˆ˜ì›”ê²½í™” - ë‰´ì§„ìŠ¤ê°€ ë‹¤ë…€ê°„ ì¹´í˜",
            snippet: "ìˆ˜ì›”ê²½í™” ë¶€ì‚°ê´‘ì—­ì‹œ í•´ìš´ëŒ€êµ¬ ì†¡ì •ì¤‘ì•™ë¡œ6ë²ˆê¸¸ 188 í“¨ì „ì°»ì§‘ í•´ë³€ì—´ì°¨ë·° ë‰´ì§„ìŠ¤ ë°©ë¬¸ 4.6ì ",
            content: "ë‰´ì§„ìŠ¤ ë©¤ë²„ë“¤ì´ ë°©ë¬¸í•œ ê²ƒìœ¼ë¡œ ìœ ëª…í•œ ì†¡ì •ì˜ í“¨ì „ì°»ì§‘ì…ë‹ˆë‹¤. ë¶€ì‚°ê´‘ì—­ì‹œ í•´ìš´ëŒ€êµ¬ ì†¡ì •ì¤‘ì•™ë¡œ6ë²ˆê¸¸ 188ì— ìœ„ì¹˜í•˜ë©° í•´ë³€ì—´ì°¨ ì˜¤ì…˜ë·°ë¥¼ ê°ìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
        });
        
        results.push({
            title: "ë¯¸í¬ì§‘ ì†¡ì •ì  - íŒë¹™ë¹™ì´ ë‹¤ë…€ê°„ í•´ë¬¼ì¥ ë§›ì§‘",
            snippet: "ë¯¸í¬ì§‘ ì†¡ì •ì  ë¶€ì‚°ê´‘ì—­ì‹œ í•´ìš´ëŒ€êµ¬ ì†¡ì •êµ¬ë•í¬ê¸¸ 70 í•´ë¬¼ì¥ ì „ë¬¸ 0507-1398-6660 íŒë¹™ë¹™ ë°©ë¬¸",
            content: "ì¤‘êµ­ ë°°ìš° íŒë¹™ë¹™ì´ ë‹¤ë…€ê°„ ì†¡ì •ì˜ í•´ë¬¼ì¥ ì „ë¬¸ì ì…ë‹ˆë‹¤. ë¶€ì‚°ê´‘ì—­ì‹œ í•´ìš´ëŒ€êµ¬ ì†¡ì •êµ¬ë•í¬ê¸¸ 70ì— ìœ„ì¹˜í•˜ë©° ì „í™”ë²ˆí˜¸ëŠ” 0507-1398-6660ì…ë‹ˆë‹¤."
        });
    }
    
    if (query.includes('ë‹¬ë§ì´ê¸¸') || query.includes('ì¹´í˜')) {
        results.push({
            title: "ë‹¬ë§ì´ê¸¸ ìŠ¤ë…¸ì‰í´ë¼ìš°ë“œ - ëŒ€ë§ˆë„ë·° ì¹´í˜",
            snippet: "ìŠ¤ë…¸ì‰í´ë¼ìš°ë“œ ë¶€ì‚°ê´‘ì—­ì‹œ í•´ìš´ëŒ€êµ¬ ë‹¬ë§ì´ê¸¸117ë²ˆê°€ê¸¸ 120-30 6ì¸µ ëŒ€ë§ˆë„ë·° ì˜¤ë¥™ë„ë·° ë¬´ë£Œì£¼ì°¨ 4.5ì ",
            content: "ë‹¬ë§ì´ê¸¸ì˜ ëŒ€í‘œ ë·° ì¹´í˜ ìŠ¤ë…¸ì‰í´ë¼ìš°ë“œì…ë‹ˆë‹¤. ë¶€ì‚°ê´‘ì—­ì‹œ í•´ìš´ëŒ€êµ¬ ë‹¬ë§ì´ê¸¸117ë²ˆê°€ê¸¸ 120-30 6ì¸µì—ì„œ ëŒ€ë§ˆë„ì™€ ì˜¤ë¥™ë„ë¥¼ í•œëˆˆì— ë°”ë¼ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤."
        });
        
        results.push({
            title: "ë‹¬ë§ì´ê¸¸ ì‚¬ë¹„ì•„ - ë‡¨ë¼ ë§›ì§‘",
            snippet: "ì‚¬ë¹„ì•„ ë¶€ì‚°ê´‘ì—­ì‹œ í•´ìš´ëŒ€êµ¬ ë‹¬ë§ì´ê¸¸117ë²ˆë¼ê¸¸ 70 1ì¸µ ë‡¨ë¼ ì „ë¬¸ ì–‘ì‹ ë‹¬ë§ì´ê¸¸ ì¸ê¸°ë§›ì§‘",
            content: "ë‹¬ë§ì´ê¸¸ì˜ ìˆ¨ì€ ë³´ì„ ê°™ì€ ì–‘ì‹ ë§›ì§‘ ì‚¬ë¹„ì•„ì…ë‹ˆë‹¤. ë¶€ì‚°ê´‘ì—­ì‹œ í•´ìš´ëŒ€êµ¬ ë‹¬ë§ì´ê¸¸117ë²ˆë¼ê¸¸ 70 1ì¸µì—ì„œ ë§›ìˆëŠ” ë‡¨ë¼ë¥¼ ì¦ê¸°ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤."
        });
    }
    
    if (query.includes('ë°€ë©´')) {
        results.push({
            title: "í•´ìš´ëŒ€ ê°€ì•¼ë°€ë©´ - 22ë…„ ì „í†µ",
            snippet: "í•´ìš´ëŒ€ ê°€ì•¼ë°€ë©´ ë¶€ì‚°ê´‘ì—­ì‹œ í•´ìš´ëŒ€êµ¬ ì¢Œë™ìˆœí™˜ë¡œ 27 ë°€ë©´ ì „ë¬¸ 22ë…„ ì „í†µ ë¶€ì‚° ëŒ€í‘œìŒì‹ 4.4ì ",
            content: "22ë…„ ì „í†µì„ ìë‘í•˜ëŠ” ë°€ë©´ ì „ë¬¸ì ì…ë‹ˆë‹¤. ë¶€ì‚°ê´‘ì—­ì‹œ í•´ìš´ëŒ€êµ¬ ì¢Œë™ìˆœí™˜ë¡œ 27ì—ì„œ ë¶€ì‚°ì˜ ëŒ€í‘œ ìŒì‹ì¸ ë°€ë©´ì„ ë§›ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤."
        });
    }
    
    if (query.includes('ì¼ì‹') || query.includes('ì˜¤ë§ˆì¹´ì„¸')) {
        results.push({
            title: "ìœ í™” - ê°€ì„±ë¹„ ì¢‹ì€ ì˜¤ë§ˆì¹´ì„¸",
            snippet: "ìœ í™” ë¶€ì‚°ê´‘ì—­ì‹œ í•´ìš´ëŒ€êµ¬ ì¢Œë™ë¡œ91ë²ˆê¸¸ 39 2ì¸µ ì˜¤ë§ˆì¹´ì„¸ ì „ë¬¸ ê°€ì„±ë¹„ ì˜ˆì•½í•„ìˆ˜ 45000-80000ì› 4.5ì ",
            content: "í•´ìš´ëŒ€ì—ì„œ ê°€ì„±ë¹„ ì¢‹ì€ ì˜¤ë§ˆì¹´ì„¸ë¡œ ìœ ëª…í•œ ìœ í™”ì…ë‹ˆë‹¤. ë¶€ì‚°ê´‘ì—­ì‹œ í•´ìš´ëŒ€êµ¬ ì¢Œë™ë¡œ91ë²ˆê¸¸ 39 2ì¸µì—ì„œ ì˜ˆì•½ í•„ìˆ˜ë¡œ ìš´ì˜ë©ë‹ˆë‹¤."
        });
    }
    
    // ë” ë§ì€ ê²€ìƒ‰ ê²°ê³¼ ì‹œë®¬ë ˆì´ì…˜...
    return results;
}

// ì‹¤ì œ WebSearch API ì—°ë™ ì˜ˆì œ (ì£¼ì„ ì²˜ë¦¬)
/*
const WebSearch = require('./webSearchAPI'); // ì‹¤ì œ WebSearch ëª¨ë“ˆ

async function realWebSearchFunction(query) {
    try {
        const results = await WebSearch({
            query: query,
            blocked_domains: ['spam-site.com'],
            allowed_domains: ['naver.com', 'diningcode.com', 'mangoplate.com']
        });
        
        return results;
    } catch (error) {
        console.error('WebSearch API ì˜¤ë¥˜:', error);
        return [];
    }
}
*/

// ë©”ì¸ ì‹¤í–‰ í•¨ìˆ˜
async function main() {
    console.log('ğŸš€ WebSearch ê¸°ë°˜ í•´ìš´ëŒ€ ë§›ì§‘ ìˆ˜ì§‘ ì‹œì‘');
    console.log('=' .repeat(60));
    
    // ì—ì´ì „íŠ¸ ì´ˆê¸°í™” (ì‹¤ì œ WebSearch í•¨ìˆ˜ ì£¼ì…)
    const agent = new RealWebSearchRestaurantAgent(webSearchFunction);
    
    try {
        console.log('ğŸ“ ìˆ˜ì§‘ ì§€ì—­: í•´ìš´ëŒ€êµ¬ ì „ì²´');
        console.log('ğŸ¯ ëª©í‘œ ë§›ì§‘ ìˆ˜: 30ê°œ');
        console.log('ğŸ” ê²€ìƒ‰ ë°©ì‹: WebSearch API');
        console.log('');
        
        // ë§›ì§‘ ë°ì´í„° ìˆ˜ì§‘ ì‹œì‘
        const restaurants = await agent.collectRestaurants("í•´ìš´ëŒ€", 30);
        
        if (restaurants.length > 0) {
            // ê²°ê³¼ ì €ì¥
            const savedFile = await agent.saveResults();
            
            console.log('\nğŸ‰ ìˆ˜ì§‘ ì™„ë£Œ!');
            console.log(`ğŸ“ ì €ì¥ íŒŒì¼: ${savedFile}`);
            console.log(`ğŸ½ï¸ ì´ ë§›ì§‘ ìˆ˜: ${restaurants.length}ê°œ`);
            
            // ìƒìœ„ 5ê°œ ë§›ì§‘ ë¯¸ë¦¬ë³´ê¸°
            console.log('\nğŸ† ìƒìœ„ 5ê°œ ë§›ì§‘:');
            restaurants.slice(0, 5).forEach((r, i) => {
                console.log(`${i+1}. ${r.name} (${r.rating}â­)`);
                console.log(`   ğŸ“ ${r.address}`);
                console.log(`   ğŸ½ï¸ ${r.specialty} | ğŸ’° ${r.priceRange}`);
                console.log('');
            });
            
        } else {
            console.log('âš ï¸ ìˆ˜ì§‘ëœ ë§›ì§‘ì´ ì—†ìŠµë‹ˆë‹¤.');
            console.log('ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì´ë‚˜ ê²€ìƒ‰ ì¿¼ë¦¬ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.');
        }
        
    } catch (error) {
        console.error('âŒ ìˆ˜ì§‘ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
        console.log('\nğŸ’¡ ë¬¸ì œ í•´ê²° ë°©ë²•:');
        console.log('1. ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸');
        console.log('2. WebSearch API í•œë„ í™•ì¸');
        console.log('3. ê²€ìƒ‰ ì¿¼ë¦¬ ìˆ˜ì •');
    }
}

// ìŠ¤í¬ë¦½íŠ¸ ì§ì ‘ ì‹¤í–‰
if (require.main === module) {
    main().catch(console.error);
}

module.exports = {
    main,
    webSearchFunction,
    RealWebSearchRestaurantAgent
};